var documenterSearchIndex = {"docs":
[{"location":"modeling_assumptions/#Modeling-assumptions","page":"Modelling assumptions","title":"Modeling assumptions","text":"","category":"section"},{"location":"modeling_assumptions/#Multiple-year-models","page":"Modelling assumptions","title":"Multiple-year models","text":"When preparing data for problems spanning a multi-year horizon (here the word year indicates an investment period: different investment decisions can be made in different years), investment candidates must adhere to the following two assumptions:\n\nIf a candidate exists in a year, then it exists in all subsequent years and is defined in the same row of the corresponding table in the input data files.\nEach candidate has the same parameters in all the years in which it exists, except for the cost which may vary with the years.\n\nThese assumptions are used not only when parsing input data files, but also in some variables/constraints where an investment candidate must be tracked along years.","category":"section"},{"location":"problem_types/#Problem-types","page":"Problem types","title":"Problem types","text":"The FlexPlan.jl package contains the following problem types:","category":"section"},{"location":"problem_types/#T(D)NEP-problem-with-storage-candidates","page":"Problem types","title":"T(D)NEP problem with storage candidates","text":"This problem solves the AC/DC grid TNEP problem considering existing and candidate storage candidates. As such, starting from an AC / (DC) network with existing storage devices, the optmisation problem finds the best AC and DC grid investments as well as storage investments. The objective function is defined as follows:\n\nSets:\n\nbeginaligned\nbc in BC - textSet of candidate AC lines \ndc in DC - textSet of candidate DC lines  \ncc in CC - textSet of candidate DC converters  \nsc in SC - textSet of candidate storage devices  \ng in G - textSet of candidate DC converters  \nt in T - textSet of planning hours  \ny in Y - textSet of planning years  \nendaligned\n\nVariables & parameters:\n\nbeginaligned\nalpha_bc y - textBinary investment decision variable of candidate AC line bc \nalpha_dc y - textBinary investment decision variable of candidate DC line dc\nalpha_cc y - textBinary investment decision variable of candidate DC converter cc\nalpha_sc y - textBinary investment decision variable of candidate storage sc \nP_g - textActive power output of generator g \nC_bc y - textInvestment cost of candidate AC line bc\nC_dc y - textInvestment cost of candidate DC line dc \nC_cc y - textInvestment cost of candidate DC converter cc\nC_sc y - textInvestment cost of candidate storage sc \nendaligned\n\nminsum_y in Y left sum_bc in BC C_bcalpha_bc y + sum_dc in BC C_dcalpha_dc y + sum_cc in CC C_ccalpha_cc y + sum_sc in BC C_scalpha_sc y + sum_t in T sum_g in G C_gtyP_gty right\n\nThe problem is defined both for transmission networks, using the linearised 'DC' power flow model as well as radial distribution grids using the linearised 'DistFlow' formulation. The problem can be solved using the following function:\n\nresult_tnep = FlexPlan.strg_tnep(data, PowerModels.DCPPowerModel, solver; setting)\nresult_dnep = FlexPlan.strg_tnep(data, FlexPlan.BFARadPowerModel, solver; setting)","category":"section"},{"location":"problem_types/#TNEP-problem-with-storage-candidates-and-demand-flexibility-(Flexible-T(D)NEP)","page":"Problem types","title":"TNEP problem with storage candidates and demand flexibility (Flexible T(D)NEP)","text":"This problem solves the AC/DC grid TNEP problem considering existing and candidate storage candidates as well demand flexibility. As such, starting from an AC / (DC) network with existing storage devices, the optmisation problem finds the best AC and DC grid investments as well as storage and demand flexibility investments. The objective function is defined in addition to the TNEP problem with storage candidates as follows:\n\nminsum_y in Y left sum_bc in BC C_bcalpha_bc y + sum_dc in BC C_dcalpha_dc y + sum_cc in CC C_ccalpha_cc y + sum_sc in BC C_scalpha_sc y + sum_t in T sum_g in G C_gtyP_gty + sum_t in T sum_fc in FC left( C_fcty^upP_fcty^up + C_fcty^downP_fcty^down + C_fcty^redP_fcty^red + C_fcty^curtP_fcty^curt right)right\n\nSets:\n\nbeginaligned\nfc in FC - textSet of demand flexibility investments \nendaligned\n\nVariables & parameters:\n\nbeginaligned\nalpha_fc y - textBinary investment decision variable for demand flexibility \nP_fc^up - textUpwards demand shifting for flexible demand fc \nP_fc^down - textDownwards demand shifting for flexible demand fc \nP_fc^red - textDemand reduction for flexible demand fc \nP_fc^curt - textDemand curtailment for flexible demand fc \nC_fc^up - textCost of upwards demand shifting for flexible demand fc \nC_fc^down - textCost of downwards demand shifting for flexible demand fc \nC_fc^red - textCost of voluntarydemand  reduction for flexible demand fc \nC_fc^curt - textCost of involuntary demand curtailment for flexible demand fc \nendaligned\n\nThe problem is defined both for transmission networks, using the linearised 'DC' power flow model as well as radial distribution grids using the linearised 'DistFlow' formulation. The problem can be solved using the following function:\n\nresult_tnep = FlexPlan.flex_tnep(data, PowerModels.DCPPowerModel, solver; setting)\nresult_dnep = FlexPlan.flex_tnep(data, FlexPlan.BFARadPowerModel, solver; setting)\n\nAdditionally, this particular problem can also be solved for both transmission and distribution networks combined, using specific data for both the transmission and the distribution network:\n\nresult_t_and_d_nep = FlexPlan.flex_tnep(t_data, d_data, PowerModels.DCPPowerModel, FlexPlan.BFARadPowerModel, solver; setting)","category":"section"},{"location":"problem_types/#Stochastic-flexbile-T(D)NEP","page":"Problem types","title":"Stochastic flexbile T(D)NEP","text":"This problem type extends the multi-year, multi-hour planning problem for a number of scenarios, e.g., variations of the planning year, and optimizes the investments taking into account the explicit scenario probabilities. As such, the objective is extended as follows, w.r.t. to the flexbile T(D)NEP problem:\n\nSets:\n\nbeginaligned\ns in S - textSet of planning scearios \nendaligned\n\nParameters:\n\nbeginaligned\npi_s - textProbability of scenario s \nendaligned\n\nminsum_s in S pi_s left sum_y in Y left sum_bc in BC C_bcalpha_bc y + sum_dc in BC C_dcalpha_dcy + sum_cc in CC C_ccalpha_ccy + sum_sc in BC C_scalpha_scy + sum_t in T sum_g in G C_gtysP_gtys + sum_t in T sum_fc in FC left( C_fctys^upP_fctys^up + C_fctys^downP_fctys^down + C_fctys^redP_fctys^red + C_fctys^curtP_fctys^curt right)right right\n\nThe problem is defined both for transmission networks, using the linearised 'DC' power flow model as well as radial distribution grids using the linearised 'DistFlow' formulation. The problem can be solved using the following function:\n\nresult_tnep = FlexPlan.stoch_flex_tnep(data, PowerModels.DCPPowerModel, solver; setting)\nresult_dnep = FlexPlan.stoch_flex_tnep(data, FlexPlan.BFARadPowerModel, solver; setting)","category":"section"},{"location":"examples/#Examples","page":"Examples","title":"Examples","text":"Some scripts are provided in /examples/ and in /test/scripts/ to test the package functionality.","category":"section"},{"location":"examples/#How-to-run-scripts","page":"Examples","title":"How to run scripts","text":"To run the above scripts, you need to activate an environment and import all the needed packages.\n\nIn a Julia REPL, choose a directory where to create the environment:\njulia> cd(\"path/to/env/dir\")\nEnter the Pkg REPL by pressing ] from the Julia REPL:\njulia> ]\nActivate the environment:\npkg> activate .\nadd the FlexPlan package:\npkg> add FlexPlan\nadd every package required by the script. For example, if the script contains import Plots, then execute\npkg> add Plots","category":"section"},{"location":"dimensions/#Model-dimensions","page":"Model dimensions","title":"Model dimensions","text":"All the optimization problems modeled in FlexPlan are multiperiod and make use of the following dimensions:\n\nhour: the finest time granularity that can be represented in a model. During an hour, each continuous variable has a constant value.\nyear: an investment period. Different investment decisions can be made in different years.\nscenario: one of the different possible sets of values related to renewable generation and consumption data.\n\nThese dimensions must be defined in each model by calling the function add_dimension! on single-period data dictionaries. The add_dimension! function takes the name of the dimension as input in form of key, as well as either integer values, e.g., for number of hours or years, or a dictionary, e.g., containing multiple scenarios. In the case of scenario input, probabilities and other meta data can be added. An example can be found below:\n\n_FP.add_dimension!(data, :hour, number_of_hours) # Add dimension, e.g. number of hours\n_FP.add_dimension!(data, :scenario, Dict(1 => Dict{String,Any}(\"probability\"=>1)), metadata = Dict{String,Any}(\"mc\"=>true)) # Add dimension, e.g. number of scenarios\n_FP.add_dimension!(t_data, :year, 1; metadata = Dict{String,Any}(\"scale_factor\"=>1)) # Add dimension of years, using cost scaling factors in metadata","category":"section"},{"location":"network_formulations/#Network-formulations","page":"Network formulations","title":"Network formulations","text":"Two different network formulations have been used in the FlexPlan package:\n\nPowerModels.DCPPowerModel is a linearised 'DC' power flow formulation that represents meshed AC/DC transmission networks;\nFlexPlan.BFARadPowerModel is a linearised 'DistFlow' formulation that represents radial AC distribution networks.\n\nFor the comprehensive formulation of the network equations, along with the detailed model for storage and demand flexibility, the readers are referred to the FlexPlan deliverable 1.2 \"Probabilistic optimization of T&D systems planning with high grid flexibility and its scalability\"\n\n@article{ergun2022probabilistic,\n  title={Probabilistic optimization of T\\&D systems planning with high grid flexibility and its scalability},\n  author={Ergun, Hakan and Sperstad, Iver Bakken and Espen Flo, B{\\o}dal and Siface, Dario and Pirovano, Guido and Rossi, Marco and Rossini, Matteo and Marmiroli, Benedetta and Agresti, Valentina and Costa, Matteo Paolo and others},\n  year={2022}\n}","category":"section"},{"location":"data_model/#Data-model","page":"Data model","title":"Data model","text":"FlexPlan.jl extends data models of the PowerModels.jl and PowerModelsACDC.jl packages by including candidate storage devices, :ne_storage, additional fields to parametrize the demand flexibility models which extend :load, some additional parameters to both existing and candidate storage devices to represent external charging and discharging of storage, e.g., to represent natural inflow and dissipation of water in hydro storage, some additional parameters extending :gen to include air quality impact and  CO2 emission costs for the generators.\n\nFor the full data model please consult the FlexPlan deliverable 1.2 \"Probabilistic optimization of T&D systems planning with high grid flexibility and its scalability\"\n\n@article{ergun2021probabilistic,\n  title={Probabilistic optimization of T\\&D systems planning with high grid flexibility and its scalability},\n  author={Ergun, Hakan and Sperstad, Iver Bakken and Espen Flo, B{\\o}dal and Siface, Dario and Pirovano, Guido and Rossi, Marco and Rossini, Matteo and Marmiroli, Benedetta and Agresti, Valentina and Costa, Matteo Paolo and others},\n  year={2021}\n}","category":"section"},{"location":"installation/#Installation-of-FlexPlan","page":"Installation","title":"Installation of FlexPlan","text":"From Julia, FlexPlan can be installed using the built-in package manager:\n\nusing Pkg\nPkg.add(\"FlexPlan\")","category":"section"},{"location":"#FlexPlan.jl-Documentation","page":"Home","title":"FlexPlan.jl Documentation","text":"","category":"section"},{"location":"#Overview","page":"Home","title":"Overview","text":"FlexPlan.jl is a Julia/JuMP package to carry out transmission and distribution network planning considering AC and DC technology, storage and demand flexibility as possible expansion candidates. Using time series input on renewable generation and demand, as well a list of candidates for grid expansion, a mixed-integer linear problem is constructed which can be solved with any commercial or open-source MILP solver. The package builds upon the PowerModels and PowerModelsACDC packages, and uses a similar structure.\n\nModelling features provided by the package include:\n\nJoint multistage, multiperiod formulation to model a number of planning years, and planning hours within years for a sequential grid expansion plan.\nStochastic formulation of the planning problem, based on scenario probabilities for a number of different time series.\nExtensive, parametrized models for storage, demand flexibility and DC grids.\nLinearized DistFlow model for radial distribution networks, considering reactive power and voltage magnitudes.\nSupport of networks composed of transmission and distribution (T&D), with the possibility of using two different power flow models.\nHeuristic procedure for efficient, near-optimal planning of T&D networks.\nBasic implementations of Benders decomposition algorithm to efficiently solve the stochastic planning problem.\n\nThese presentations provide a brief introduction to various aspects of FlexPlan:\n\nNetwork expansion planning with FlexPlan.jl [PDF] – EnergyVille, 16/02/2023\nFlexPlan.jl – An open-source Julia tool for holistic transmission and distribution grid planning [PDF] – OSMSES 2023 conference, Aachen, 28/03/2023","category":"section"},{"location":"#Acknowledgements","page":"Home","title":"Acknowledgements","text":"This code has been developed as part of the European Union’s Horizon 2020 research and innovation programme under the FlexPlan project (grant agreement no. 863819).\n\nDeveloped by:\n\nHakan Ergun (KU Leuven / EnergyVille)\nMatteo Rossini (RSE)\nMarco Rossi (RSE)\nDamien Lepage (N-Side)\nIver Bakken Sperstad (SINTEF)\nEspen Flo Bødal (SINTEF)\nMerkebu Zenebe Degefa (SINTEF)\nReinhilde D'Hulst (VITO / EnergyVille)\n\nThe developers thank Carleton Coffrin (Los Alamos National Laboratory) for his countless design tips.","category":"section"},{"location":"#Citing-FlexPlan.jl","page":"Home","title":"Citing FlexPlan.jl","text":"If you find FlexPlan.jl useful in your work, we kindly request that you cite the following publication (preprint):\n\n@inproceedings{FlexPlan.jl,\n    author = {Matteo Rossini and Hakan Ergun and Marco Rossi},\n    title = {{FlexPlan}.jl – An open-source {Julia} tool for holistic transmission and distribution grid planning},\n    booktitle = {2023 Open Source Modelling and Simulation of Energy Systems ({OSMSES})},\n    year = {2023},\n    month = {mar},\n    publisher = {{IEEE}},\n    doi = {10.1109/osmses58477.2023.10089624},\n    url = {https://doi.org/10.1109/osmses58477.2023.10089624}\n}","category":"section"},{"location":"#License","page":"Home","title":"License","text":"This code is provided under a BSD 3-Clause License.","category":"section"},{"location":"tutorial/#Tutorial","page":"Tutorial","title":"Tutorial","text":"This page shows how to define and solve network planning problems using FlexPlan.\n\ntip: Tip\nBefore following this tutorial you might want to have a look at some examples.","category":"section"},{"location":"tutorial/#1.-Import-packages","page":"Tutorial","title":"1. Import packages","text":"FlexPlan builds on PowerModels and PowerModelsACDC packages. You can declare the packages as follows, and use short names to access specific functions without having to type the full package name every time.\n\nimport PowerModels as _PM\nimport PowerModelsACDC as _PMACDC\nimport FlexPlan as _FP\n\nAny other additional package that you might need, e.g., for printing, plotting, exporting results etc. can be declared in the same way.\n\nAlso, the solution of the optimization problem will require an MILP solver. As FlexPlan depends on JuMP package, it can be interfaced with any of the optimisation solvers supported by JuMP. You can declare and initialize the solver as follows:\n\nimport HiGHS\noptimizer = _FP.optimizer_with_attributes(HiGHS.Optimizer, \"output_flag\"=>false)\n\ntip: Tip\nFlexPlan exports JuMP.optimizer_with_attributes function, so you don't have to import JuMP just to use this function.","category":"section"},{"location":"tutorial/#2.-Input-data","page":"Tutorial","title":"2. Input data","text":"The data model of FlexPlan is very similar to the ones of PowerModels/PowerModelsACDC. As such, a data dictionary containing all information is passed to the optimisation problem. The standard network elements such as generators, buses, branches, etc. are extended with the existing and candidate storage and demand flexibility elements (see section Data model for complete description). The multi-network modelling functionality of PowerModels is used to represent the different number of scenarios, planning years and planning hours within the year. The procedure is further explained under section Model dimensions.","category":"section"},{"location":"tutorial/#FlexPlan.jl-sample-data","page":"Tutorial","title":"FlexPlan.jl sample data","text":"The package contains some sample test cases comprising both grid data and multi-scenario time series, located under /test/data/ and named as its subdirectories. These test cases have been used in for the validation of the model in the FlexPlan deliverable 1.2 \"Probabilistic optimization of T&D systems planning with high grid flexibility and its scalability\".\n\n/test/io/load_case.jl provides functions to load such test cases. The functions are named load_* where * is the name of a test case. For example, case6 can be loaded using:\n\nconst _FP_dir = dirname(dirname(pathof(_FP))) # Root directory of FlexPlan package\ninclude(joinpath(_FP_dir,\"test/io/load_case.jl\"))\ndata = load_case6(; number_of_hours=24, number_of_scenarios=1, number_of_years=1)\n\nSupported parameters are explained in load_* function documentation: in a Julia REPL, type ? followed by a function name to read its documentation.","category":"section"},{"location":"tutorial/#Using-your-own-data","page":"Tutorial","title":"Using your own data","text":"FlexPlan provides functions that facilitate the construction of a multinetwork data dictionary using:\n\nnetwork data from Matpower-like .m files;\ntime series data from dictionaries of vectors, each vector being a time series.\n\nThe procedure is as follows.\n\nCreate a single-network data dictionary.\nLoad network data from Matpower-like .m files (see e.g. /test/data/case6/case6_2030.m). Use parse_file.\nSpecify the dimensions of the data. Use add_dimension!.\nScale costs and lifetime of grid expansion elements. Use scale_data!.\nCreate a dictionary of vectors that contains time series. You have to write your own code for performing this step.\nCreate a multinetwork data dictionary by combining the single-network data dictionary and the time series. Use make_multinetwork.\n\nHere is some sample code to get started:\n\nconst _FP_dir = dirname(dirname(pathof(_FP))) # Root directory of FlexPlan package\nsn_data = _FP.parse_file(joinpath(_FP_dir,\"test/data/case6/case6_2030.m\"))\n_FP.add_dimension!(sn_data, :hour, 24)\n_FP.add_dimension!(sn_data, :scenario, Dict(1 => Dict{String,Any}(\"probability\"=>1)))\n_FP.add_dimension!(sn_data, :year, 1; metadata = Dict{String,Any}(\"scale_factor\"=>1))\n_FP.scale_data!(sn_data)\n\ninclude(joinpath(_FP_dir,\"test/io/create_profile.jl\")) # Functions to load sample time series. Use your own instead.\nsn_data, loadprofile, genprofile = create_profile_data_italy!(sn_data)\ntime_series = create_profile_data(24, sn_data, loadprofile, genprofile) # Your time series should have the same format as this `time_series` dict\n\nmn_data = _FP.make_multinetwork(sn_data, time_series)","category":"section"},{"location":"tutorial/#Coupling-of-transmission-and-distribution-networks","page":"Tutorial","title":"Coupling of transmission and distribution networks","text":"FlexPlan provides the possiblity to couple multiple radial distribution networks to the transmission system, for solving the combined T&D grid expansion problem. For the meshed transmission system the linearized 'DC' power flow formulation is used, whereas radial networks are modelled using the linearized DistFlow model (more information can be found under Network formulations section).\n\nInput data consist of:\n\none dictionary for the trasmission network;\na vector of dictionaries, each item representing one distribution network.\n\nThe only difference with respect to the case of a single network is that for each distribution network it is necessary to specify which bus of the transmission network it is to be attached to. This is done by adding a t_bus key in the distribution network dictionary.\n\nHere is an example (using FlexPlan sample data):\n\nnumber_of_hours = 4\nnumber_of_scenarios = 2\nnumber_of_years = 1\nconst _FP_dir = dirname(dirname(pathof(_FP))) # Root directory of FlexPlan package\ninclude(joinpath(_FP_dir, \"test/io/load_case.jl\"))\n\n# Transmission network data\nt_data = load_case6(; number_of_hours, number_of_scenarios, number_of_years)\n\n# Distribution network 1 data\nd_data_sub_1 = load_ieee_33(; number_of_hours, number_of_scenarios, number_of_years)\nd_data_sub_1[\"t_bus\"] = 3 # States that this distribution network is attached to bus 3 of transmission network\n\n# Distribution network 2 data\nd_data_sub_2 = deepcopy(d_data_sub_1)\nd_data_sub_2[\"t_bus\"] = 6\n\nd_data = [d_data_sub_1, d_data_sub_2]","category":"section"},{"location":"tutorial/#3.-Solve-the-problem","page":"Tutorial","title":"3. Solve the problem","text":"Finally, the problem can be solved using (example of stochastic planning problem with storage & demand flexiblity candidates):\n\nresult = _FP.simple_stoch_flex_tnep(data, _PM.DCPPowerModel, optimizer; setting=Dict(\"conv_losses_mp\"=>false))\n\nof, for the combined T&D model:\n\nresult = _FP.simple_stoch_flex_tnep(t_data, d_data, _PM.DCPPowerModel, _FP.BFARadPowerModel, optimizer; t_setting=Dict(\"conv_losses_mp\"=>false))\n\nFor other possible problem types and decomposed models, please check the Problem types section.","category":"section"},{"location":"tutorial/#4.-Inspect-your-results","page":"Tutorial","title":"4. Inspect your results","text":"The optimization results are returned as a Julia Dict, so you can easily write your custom code to retrieve the results you need. However some basic functions for displaying and exporting results are provided in the package.","category":"section"},{"location":"tutorial/#Check-termination-status","page":"Tutorial","title":"Check termination status","text":"First thing to do is check the termination status of the solver to make sure that an optimal solution has been found.\n\nYou may want to check the value of \"termination_status\" like this:\n\n@assert result[\"termination_status\"] ∈ (_FP.OPTIMAL, _FP.LOCALLY_SOLVED) \"$(result[\"optimizer\"]) termination status: $(result[\"termination_status\"])\"\n\ntip: Tip\nFlexPlan exports JuMP's TerminationStatusCode and ResultStatusCode, so you can access these types as above, without having to import JuMP just for that.","category":"section"},{"location":"tutorial/#Check-solve-time","page":"Tutorial","title":"Check solve time","text":"The total solve time is also available, under \"solve_time\":\n\nprintln(\"Total solve time: $(round(result[\"solve_time\"], digits=1)) seconds.\")","category":"section"},{"location":"tutorial/#Access-solution","page":"Tutorial","title":"Access solution","text":"To obtain power flow results, you can use the print_summary and component_table functions of PowerModels.\n\nFurther, several functions are provided to access to optimal investments and costs by category, view power profiles, and display the network topology. Generally, they return a DataFrame. They also allow you to save numerical results as CSV files and plots in any format supported by Plots.jl. All these functions are contained in /test/io/sol.jl, but are not part of FlexPlan module to avoid unwanted dependencies. Include them with\n\nconst _FP_dir = dirname(dirname(pathof(_FP))) # Root directory of FlexPlan package\ninclude(joinpath(_FP_dir,\"test/io/sol.jl\"))\n\nand import the required packages.","category":"section"}]
}
